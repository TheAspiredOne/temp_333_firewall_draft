Allow any host from the network 10.229.*.* to access the ftp service of your Windows host EXCEPT for connections coming from hosts belonging to group X+1 (or group 1 if X=13) AND connections coming from hosts 10.229.100.96 and 10.229.96.*

	iptables -A INPUT -p ftp -s 10.229.100.96 --dport WINDOWS_PORT -j DROP
	iptables -A INPUT -p ftp -s 10.229.96.* --dport WINDOWS_PORT -j DROP
	iptables -A INPUT -p ftp -s 10.229.6.1 --dport WINDOWS_PORT -j DROP
	iptables -A INPUT -p ftp -s 10.229.6.2 --dport WINDOWS_PORT -j DROP

	iptables -A INPUT -p ftp --dport WINDOWS_PORT -j ACCEPT


Allow any host from the network 10.229.*.* to access the http service of your Linux host EXCEPT for connections coming from hosts belonging to group X-1 (or group 13 if X=1) AND connections coming from hosts 10.229.100.97 and 10.229.97.*

	iptables -A INPUT -p http -s 10.229.4.1 --dport LINUX_PORT -j DROP
	iptables -A INPUT -p http -s 10.229.4.2 --dport LINUX_PORT -j DROP
	iptables -A INPUT -p http -s 10.229.100.97 --dport LINUX_PORT -j DROP
	iptables -A INPUT -p http -s 10.229.97.* --dport LINUX_PORT -j DROP

	iptables -A INPUT -p http -s 10.229.* --dport LINUX_PORT -j ACCEPT



An http request that is arriving from a network outside of your group and is allowed access (as per the previous rule) should be able to access your web server regardless if it attempts to connect to port 80 or 8080. That is, to networks outside of your group your webserver appears to also be listening on port 80.


	some kind of forwarding required



Allow any host from the network 10.229.*.* to access the tftp service of your Linux host EXCEPT for connections coming from hosts belong to group X+2 (or group 1 for X=12 and group 2 for X=13) AND connections coming from hosts 10.229.100.96 and 10.229.96.*

	iptables -A INPUT -p tftp -s 10.229.7.1 --dport LINUX_PORT -j DROP
	iptables -A INPUT -p tftp -s 10.229.7.2 --dport LINUX_PORT -j DROP
	iptables -A INPUT -p tftp -s 10.229.100.96 --dport LINUX_PORT -j DROP	
	iptables -A INPUT -p tftp -s 10.229.96.* --dport LINUX_PORT -j DROP

	iptables -A INPUT -p tftp -s 10.229.* --dport LINUX_PORT -j DROP




Allow any host from any network to connect to the ssh service port on any of your group's hosts as well as allow ICMP echo messages and responses (pings) from any host from any network.



